steps:
  # Construye la imagen para cada servicio
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/core-sga-api:latest','-f','./services/core_sga/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/ai-engine-api:latest','-f','./services/ai_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/risk-engine-api:latest','-f','./services/risk_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/compliance-engine-api:latest','-f','./services/compliance_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/objectives-engine-api:latest','-f','./services/objectives_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/ghg-engine-api:latest','-f','./services/ghg_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/audit-engine-api:latest','-f','./services/audit_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/auth-engine-api:latest','-f','./services/auth_engine/Dockerfile','.']
  - name: gcr.io/cloud-builders/docker
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/reporting-engine-api:latest','-f','./services/reporting_engine/Dockerfile','.']

options:
  logging: CLOUD_LOGGING_ONLY

# Le dice a Cloud Build que suba todas las im√°genes construidas a Artifact Registry
images:
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/core-sga-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/ai-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/risk-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/compliance-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/objectives-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/ghg-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/audit-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/auth-engine-api:latest
  - us-central1-docker.pkg.dev/$PROJECT_ID/sga-services/reporting-engine-api:latest
